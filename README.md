# Effective Mobile Test Task
Данный репозиторий содержит решение тестового задания для компании Effective Mobile

## Задание
Необходимо разработать консольное приложение (по желанию можно WinForms либо WebApi) для службы доставки, которое фильтрует заказы в зависимости от количества обращений в конкретном районе города и времени обращения с и по.

Входные данные для каждой строки содержат следующую информацию:
* Номер заказа - можно использовать уникальный идентификатор или придумать свой;
* Вес заказа в килограммах;
* Район заказа, можно придумать либо название либо идентификатор района;
* Время доставки заказа - в формате: `yyyy-MM-dd HH:mm:ss`.

Для исходных данных можно использовать либо файл с данными (рекомендуется) либо любые СУБД, которые можно легко установить для проверки.
Также необходимо сделать логирование основных операций, а также валидацию входных данных.

В результирующий файл либо БД необходимо вывести результат фильтрации заказов для доставки в конкретный район города в ближайшие полчаса после времени первого заказа.
Данные для фильтрации (можно передавать через параметры консольного приложения `_cityDistrict`, `_firstDeliveryDateTime`):
* Район доставки;
* Время первой доставки.

Выходные файлы:
* логирование - в случае консольного приложения определить задание адреса файла через командную строку: `_deliveryLog` - путь к файлу с логами, либо создать в СУБД таблицу с логами;
* результат - записывать по адресу: `_deliveryOrder` - путь к файлу с результатом выборки либо в СУБД таблицу.

По возможности, кроме передачи параметров через командную строку либо форму, можно реализовать частичную либо полную передачу параметров через файлы конфигурации или переменные среды. Программа не должна ломаться от некорректных входных данных (реализовать в валидации), ошибок ввода-вывода и прочим причинам, которые можно предусмотреть (реализовать обработку возможных ошибок).

Решение должно быть предоставлено в виде исходных кодов в архиве, при необходимости с дампом базы данных, в виде архива или ссылки на репозиторий с решением.
Код должен быть оптимальным, читаемым для разработчика и удобным для пользователя, при разработке желательно покрытие несколькими тестами и использование общераспространенных практик (паттерны проектирования, KISS...)

Результат тестового задания должен содержать текстовый файл `readme.txt` с инструкцией по настройке и конфигурированию приложения (если необходимо).

## Инструкция по запуску

### Запуск проекта для новой базы данных
Чтобы запустить проект с использованием Entity Framework Core, следуйте следующим шагам:

1. **Сборка Docker-образа** Перейдите в директорию, где находится файл [Dockerfile](DeliveryService/DeliveryService/Docker/Dockerfile), и выполните команду для создания образа:
```bash
docker build -t effective_mobile_delivery .
```

2. **Запуск Docker-контейнера** После успешной сборки образа запустите контейнер с помощью следующей команды:
```bash
docker run -d -p 5436:5436 --name effective_mobile_delivery effective_mobile_delivery
```

3. **Применение миграций** В [корне](DeliveryService/DeliveryService/) проекта выполните команду для применения миграций к созданной базе данных:
```bash
dotnet ef database update
```
После выполнения всех шагов база данных будет успешно создана и обновлена, а также в ней будут добавлены тестовые данные.


### Запуск проекта с использованием существующей базы данных
Если у вас уже есть база данных, выполните следующие шаги для настройки проекта:
1. Обновите строку подключения:
    * В файлах [appsettings.Development.json](DeliveryService/DeliveryService/Configuration/appsettings.Development.json) и [appsettings.Production.json](DeliveryService/DeliveryService/Configuration/appsettings.Production.json) укажите строку подключения к вашей базе данных в разделе DbOptions:ConnectionString
2. Запустите SQL-скрипты:
    * Последовательно выполните SQL-скрипты [ddl.sql](DeliveryService/DeliveryService/InititalDb/ddl.sql) и [dml.sql](DeliveryService/DeliveryService/InititalDb/dml.sql):
        * ddl.sql: Этот скрипт создаст необходимые таблицы в вашей базе данных
        * dml.sql: Этот скрипт заполнит таблицы начальными данными

После выполнения этих шагов ваш проект будет готов к работе с уже существующей базой данных.


## Запуск проекта с параметрами

Проект можно запускать с использованием следующих параметров:

* --districtId или сокращенно -d: идентификатор района
* --deliveryTime или сокращенно -t: время доставки заказа в формате yyyy-MM-dd HH:mm:ss

**Важно:** Если не будет передано ни одного параметра, будет выдана ошибка, и проект не сможет запуститься.

### Пример использования:

```bash
dotnet run --districtId 10 --deliveryTime "2024-10-28 13:30:00"
```
